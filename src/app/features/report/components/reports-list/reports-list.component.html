<div class="container myContentClass">
    <h2 class="card-subheading center" >Liste des rapports de stage</h2><br>
    <p class="card-heading"><small>Ci-dessous vous trouverez la liste des rapports de stages/projects des étudiants de l'ENSAM Casablanca.</small></p>
    
    <div class="wrap" >
        <div class="search">
            <div style="width: 100%;" class="input-box">
                <!-- <input style="padding-left: 100px;" type="text" class="searchTerm" [(ngModel)]="filterAnneeParDefaut" data-placeholder-focus="false"> -->
                <select style="padding-left: 100px;" class="searchTerm" name="type" [(ngModel)]="filterAnneeParDefaut">
                    <option *ngFor="let year of years" value="{{year}}">{{year}}</option>
                </select>
                <span class="unit" >Année* : </span>
            </div>
            <div style="width: 100%;" class="input-box">
                <!-- <input style="padding-left: 100px;" type="text" class="searchTerm" [(ngModel)]="filterAnneeParDefaut" data-placeholder-focus="false"> -->
                <select style="padding-left: 100px; border-left: 0px; border-radius: 0%;" class="searchTerm" name="type" [(ngModel)]="selectFiliereParDefaut">
                    <option value="GI">GI</option>
                    <option value="GM">GM</option>
                    <option value="GE">GE(ancienne)</option>
                    <option value="GEM">GEM</option>
                    <option value="IAGI">IAGI</option>
                    <option value="MSEI">MSEI</option>
                    <option value="Tout">Tout</option>
                </select>
                <span class="unit" >Filiere* : </span>
            </div>

          <!-- <input type="text" class="searchTerm" placeholder="What ar" style="border-left:0px; border-radius:0px"> -->
           <button type="submit" class="searchButton" (click)="ApplyFilters()">
             <i class="fa fa-search"></i>
          </button>
        </div>
     </div>

    <!-- Default filters -->
        <!-- <div  id="header-search-people" class="form-area" novalidate="novalidate" autocomplete="off">
        <div class="row">
            <div class="col-md-8">
                <div class="styled-input multi" style="height: 60px;">

                    <div>
                        <input type="text" [(ngModel)]="filterAnneeParDefaut" data-placeholder-focus="false">
                        <label>Année*</label>
                    </div>

                    <div id="select-type" class="type">
                        <select name="type" [(ngModel)]="selectFiliereParDefaut">
                            <option value="GI">GI</option>
                            <option value="GM">GM</option>
                            <option value="GE">GE(ancienne)</option>
                            <option value="GEM">GEM</option>
                            <option value="IAGI">IAGI</option>
                            <option value="MSEI">MSEI</option>
                        </select>
                        <label>Filière*</label>
                        <svg class="chevron-down" width="17px" height="10px" viewBox="0 0 17 10" version="1.1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink">
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                <g id="UI-Elements-Forms" transform="translate(-840.000000, -753.000000)" stroke="#4A4A4A" stroke-width="0.9">
                                    <g id="Done-Copy-2" transform="translate(622.000000, 727.000000)">
                                        <polyline id="Rectangle-16" transform="translate(226.400000, 27.400000) rotate(-45.000000) translate(-226.400000, -27.400000) "
                                            points="231.8 32.8 221 32.8 221 22"></polyline>
                                    </g>
                                </g>
                            </g>
                        </svg>
                    </div>

                </div>
            </div>
            <div class="col-md-4 no-pad-left-10">
                <button type="submit" class="primary-btn serach-btn" (click)="ApplyFilters()">Chercher</button>
            </div>
      
    </div>
    </div>
    <hr> -->

    <!-- FILTERS -------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <div class="advanced" style="margin-bottom: 10px; margin-top: 10px;"><a (click)="ShowHideAdvancedSearch()"><small> Filtres Avancées </small><i name="arrow-down" class="visibleArrow fa fa-angle-down" ></i> <i name="arrow-up" class="hidden fa fa-angle-up"></i></a></div>

    <div name="advancedSearch" class="hidden">
    <!-- First line of filters -->
    <div id="header-search-people" class="form-area " novalidate="novalidate" autocomplete="off">
        <div class="row">
            <div class="col-md-10">
                <div class="styled-input multi" style="height: 60px;">
                    <div>
                        <input type="text" [(ngModel)]="filterText" data-placeholder-focus="false">
                        <label>Intitulé Stage</label>
                    </div>
                    <div>
                        <input type="text" [(ngModel)]="filterPromotion" data-placeholder-focus="false">
                        <label>Promotion</label>
                    </div>
                    <!-- <div id="select-type" class="type">
                        <select name="type" [(ngModel)]="selectFiliere">
                            <option value="GI">GI</option>
                            <option value="GM">GM</option>
                            <option value="GE">GE(ancienne)</option>
                            <option value="GEM">GEM</option>
                            <option value="IAGI">IAGI</option>
                            <option value="MSEI">MSEI</option>
                        </select>
                        <label>Filière</label>
                        <svg class="chevron-down" width="17px" height="10px" viewBox="0 0 17 10" version="1.1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink">
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                <g id="UI-Elements-Forms" transform="translate(-840.000000, -753.000000)" stroke="#4A4A4A" stroke-width="0.9">
                                    <g id="Done-Copy-2" transform="translate(622.000000, 727.000000)">
                                        <polyline id="Rectangle-16" transform="translate(226.400000, 27.400000) rotate(-45.000000) translate(-226.400000, -27.400000) "
                                            points="231.8 32.8 221 32.8 221 22"></polyline>
                                    </g>
                                </g>
                            </g>
                        </svg>
                    </div> -->
                    <div id="select-type" class="type">
                        <select name="type" [(ngModel)]="selectedReportType">
                            <!-- <option value="Tout">Tout</option> -->
                            <option value="Initiation">Initiation</option>
                            <option value="PFA">PFA</option>
                            <option value="PFE">PFE</option>
                        </select>
                        <label>Type rapport</label>
                        <svg class="chevron-down" width="17px" height="10px" viewBox="0 0 17 10" version="1.1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink">
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                <g id="UI-Elements-Forms" transform="translate(-840.000000, -753.000000)" stroke="#4A4A4A" stroke-width="0.9">
                                    <g id="Done-Copy-2" transform="translate(622.000000, 727.000000)">
                                        <polyline id="Rectangle-16" transform="translate(226.400000, 27.400000) rotate(-45.000000) translate(-226.400000, -27.400000) "
                                            points="231.8 32.8 221 32.8 221 22"></polyline>
                                    </g>
                                </g>
                            </g>
                        </svg>
                    </div>
                </div>
            </div>
            <div class="col-md-2 no-pad-left-10">
                <button type="submit" class="primary-btn serach-btn" (click)="renitialiserFiltres()">Reinitialiser</button>
            </div>
        </div>
        
    </div>

    <!-- Second line of filters -->
    <div  id="header-search-people" class="form-area " novalidate="novalidate" autocomplete="off">
        <div class="row">
            <div class="col">
                <div class="styled-input multi" style="height: 60px;">
                    <div>
                        <input type="text" [(ngModel)]="StudentfilterText" data-placeholder-focus="false">
                        <label>Etudiant</label>
                    </div>
                    <div>
                        <label>Rapp. confidentiel</label>
                        <input style="margin-left: 30px; margin-top: 10px;" type="checkbox" [(ngModel)]="selectedConfidentiel" data-placeholder-focus="false">
                    </div>
                    <div>
                        <label>Date début</label>
                        <input type="date" name="dateDebut" #dateDebut="ngModel"
                        pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))"
                        [(ngModel)]="StartDateReport" data-placeholder-focus="false" style="width: 45%; margin-left: 120px; ">
                    </div>
                    <div>
                        <label>Date fin</label>
                        <input type="date" name="dateDebut" #dateDebut="ngModel"
                        pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))"
                        [(ngModel)]="EndDateReport" data-placeholder-focus="false" style="width: 45%; margin-left: 120px;">
                    </div>

                    <div id="select-type">
                        <select (click)="ShowHideStageFilters()" name="type" [(ngModel)]="selectedStageProjet">
                            <option value="stage">stage</option>
                            <option value="projet">projet</option>
                        </select>
                        <label>Stage/Projet</label>
                        <svg class="chevron-down" width="17px" height="10px" viewBox="0 0 17 10" version="1.1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink">
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                <g id="UI-Elements-Forms" transform="translate(-840.000000, -753.000000)" stroke="#4A4A4A" stroke-width="0.9">
                                    <g id="Done-Copy-2" transform="translate(622.000000, 727.000000)">
                                        <polyline id="Rectangle-16" transform="translate(226.400000, 27.400000) rotate(-45.000000) translate(-226.400000, -27.400000) "
                                            points="231.8 32.8 221 32.8 221 22"></polyline>
                                    </g>
                                </g>
                            </g>
                        </svg>
                    </div>
                </div>
            </div>
        </div>
    </div>

    </div>

    <!-- Third line of filters -->
    <div name="StageFilters" id="header-search-people" class="form-area hidden" novalidate="novalidate" autocomplete="off">
        <div class="row">
            <div class="col">
                <div class="styled-input multi" style="height: 60px;">
                    <div>
                        <input type="text" [(ngModel)]="VillePaysText" data-placeholder-focus="false">
                        <label>Ville/Pays Stage</label>
                    </div>
                    <div>
                        <input type="text" [(ngModel)]="SocieteText" data-placeholder-focus="false">
                        <label>Société de Stage</label>
                    </div>
                    <div>
                        <input type="text" [(ngModel)]="SecteurSocieteText" data-placeholder-focus="false">
                        <label>Secteur Société</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <hr>

    <!-- LIST OF REPORTS -------------------------------------------------------------------------------------------------------------------------->
    <div  *ngFor="let report of reports 
    | reportFilter : filterText | stageProjetFilter : selectedStageProjet | confidentielFilter : selectedConfidentiel
    | reportTypeFilter : selectedReportType | dateRangeFilter : StartDateReport:EndDateReport | studentFilter : StudentfilterText
    | villePaysFilter : VillePaysText | societeFilter : SocieteText | secteurSocieteFilter : SecteurSocieteText
    | promotionFilter : filterPromotion | filiereFilter : selectFiliere
    | paginate : { itemsPerPage: 6, currentPage: p } ;
    let i = index"
        [class.active]="i == currentIndex"
        (click)="setActiveReport(report, i)" style="padding: 0.4%;">
        <article class="postcard light blue" style="height: 230px; margin: 0%;" >
            <div class="postcard__text t-dark">
                <div class="row">
                    <div class="col-6">
                        <h5>
                            <I><b>{{ report.stage_ou_projet ? "Stage" : "Projet" }} : </b></I>
                            <a routerLink="/rapport/info/{{ report.id }}">{{ capitalizeFirstLetter(report.intitule_stage) }}</a>
                        </h5>
                        
                        <div class="postcard__subtitle small"> <!-- path: 'profile-etudiant/:id' -->
                        <i class="icon-user mr-2 "></i><span class="classLink"><a routerLink="/profile-etudiant/{{report.fk_etudiant.id}}" style="margin-right:20px;">{{ report.fk_etudiant.prenom }} {{ report.fk_etudiant.nom }}</a></span>
                        <time><i class="icon-calendar mr-2"></i> {{ report.horodateur | date: 'dd/MM/yyyy'}}  </time>
                        </div>
                        <div class="postcard__bar"></div>
                        <!-- <hr width="15%" align="left">  -->
                        <div> <small>
                            {{ report.resume_rapport }}</small>
                        </div>

                        <div class="postcard__tagbox" >
                            <div class="tag__item play blue" *ngIf="!!report.mots[0].mot">
                              <i class="icon-tag mr-2"></i> {{report.mots[0].mot}}
                            </div>
                            <div class="tag__item play blue" *ngIf="!!report.mots[1].mot">
                              <i class="icon-tag mr-2"></i> {{report.mots[1].mot}}
                            </div>
                            <div class="tag__item play blue" *ngIf="!!report.mots[2].mot">
                              <i class="icon-tag mr-2"></i> {{report.mots[2].mot}}
                            </div>
                            <div class="tag__item play blue" *ngIf="report.mots?.length >=4">
                              <i class="icon-tag mr-2"></i> {{report.mots[3].mot}}
                            </div>
                            <div class="tag__item play blue" *ngIf="report.mots?.length ==5">
                              <i class="icon-tag mr-2"></i> {{report.mots[4].mot}}
                            </div>
                        </div> 
                    </div>
                    <div class="col-6">
                        <br>
                        <div *ngIf="report.stage_ou_projet">
                            <div>
                                <label><strong>Société de stage : </strong></label>
                                {{ capitalizeFirstLetter(report.societe_stage) }} <span *ngIf="report.secteur_societe != null">( {{ capitalizeFirstLetter(report.secteur_societe) }} )</span>
                            </div>
                            <div *ngIf="report.ville_societe != null">
                                <label><strong>Ville de stage : </strong></label>
                                {{ capitalizeFirstLetter(report.ville_societe) }} <span *ngIf="report.pays_societe != null">( {{ capitalizeFirstLetter(report.pays_societe) }} )</span>
                            </div>
                        </div>
                        <br>
                        <div class="row">
                            <div class="col-6"></div>
                            <div class="col-3" class="classLink" *ngIf=" (report.fk_etudiant.id==isStudent) || isAdministrator"><a routerLink="/rapport/{{ report.id }}" ><u>modifier</u> </a></div>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <div class="col-3" class="classLink"><a routerLink="/rapport/info/{{ report.id }}" ><u>plus de détails</u></a></div>
                        </div>
                    </div>
                </div>
                
            </div>
        </article>
    </div>
    <br>
    <app-spinner message="" class="mySpinnerClass" [class.hidden]="hideSpinner"></app-spinner>
    <div  class="center">
        <pagination-controls (pageChange)="p = $event"></pagination-controls>
    </div>

    <!-- <hello [page]="reports.length" #pageinator></hello> -->
</div> 