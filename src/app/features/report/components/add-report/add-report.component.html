<div class="container contact-form myContentClass" *ngIf="!submitted">
        <form (ngSubmit)="saveReport()" #reportForm="ngForm" >
            <h3>Veuillez renseigner les informations relatives à  votre stage/projet :</h3>
                <hr>
                <p>Informations générales sur le stage/projet</p>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <select class="custom-select form-control" id="nature" (click)="myFunction()" name="nature" required
                            [(ngModel)]="report.stage_ou_projet">
                                <option *ngFor="let nature of natures" [ngValue]="nature.nature" selected>
                                    {{ nature.name }}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <select class="custom-select form-control" id="type_rapport" name="type_rapport" required
                            [(ngModel)]="report.type_rapport" #type_rapport="ngModel">
                                <option *ngFor="let type of types_rapport" [ngValue]="type" selected>
                                    {{ type }}
                                </option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="text" [(ngModel)]="report.intitule_stage" required #intitule="ngModel" 
                            class="form-control" name="intitule" placeholder="Intitulé*" maxlength="200"  />
                            <span class="unit">Intitulé : </span>
                            <div *ngIf="intitule.errors && (intitule.dirty || intitule.touched)" class="alert alert-danger">
                                <div [hidden]="!intitule.errors?.required">
                                    L'intitulé du stage/projet est requis.
                                </div>
                                <div [hidden]="!intitule.errors?.maxlength">
                                    Ce champ ne peut pas comporter plus de 200 caractères.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group row input-box">
                            <label for="inputPassword" class="col-sm-3 col-form-label">Date de début</label>
                            <div class="col-sm-9">
                            <input type="date" class="form-control" name="dateDebut" required #dateDebut="ngModel"
                                pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))"
                            [(ngModel)]="report.date_debut_stage" placeholder="Date de début*" >
                            <div *ngIf="dateDebut.errors && (dateDebut.dirty || dateDebut.touched)" class="alert alert-danger">
                                <div [hidden]="!dateDebut.errors?.required">
                                    La date de début du stage/projet est requise.
                                </div>
                                <div [hidden]="!dateDebut.errors?.pattern">
                                    Veuillez entrer une date valide !
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group row input-box">
                            <label class="col-sm-3 col-form-label">Date de fin</label>
                            <div class="col-sm-9">
                            <input type="date" class="form-control" name="dateFin" required #dateFin="ngModel"
                                pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])-(?:30))|(?:(?:0[13578]|1[02])-31))"
                            [(ngModel)]="report.date_fin_stage" placeholder="Date de fin*" >
                            <div *ngIf="dateFin.errors && (dateFin.dirty || dateFin.touched)" class="alert alert-danger">
                                <div [hidden]="!dateFin.errors?.required">
                                    La date de fin du stage/projet est requise.
                                </div>
                                <div [hidden]="!dateFin.errors?.pattern">
                                    Veuillez entrer une date valide !
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <p>Informations sur la société</p>
                <div class="row">
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="text" [(ngModel)]="report.societe_stage" #societe="ngModel" name="societe"
                            class="form-control nature" placeholder="Société*" [required]="!stageDisabled" 
                            [maxlength]="stageDisabled ? false : 200" [disabled]="stageDisabled" />
                            <span class="unit">Société : </span>
                            <div *ngIf="societe.errors && (societe.dirty || societe.touched)" class="alert alert-danger">
                                <div [hidden]="!societe.errors?.required">
                                    La société du stage est requise.
                                </div>
                                <div [hidden]="!societe.errors?.maxlength">
                                    Ce champ ne peut pas comporter plus de 200 caractères.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="text" [(ngModel)]="report.secteur_societe" #secteur="ngModel" name="secteur"
                            class="form-control nature" placeholder="Secteur*" [required]="!stageDisabled" 
                            [maxlength]="stageDisabled ? false : 200" [disabled]="stageDisabled"/>
                            <span class="unit">Secteur : </span>
                            <div *ngIf="secteur.errors && (secteur.dirty || secteur.touched)" class="alert alert-danger">
                                <div [hidden]="!secteur.errors?.required">
                                    Le secteur du stage est requis.
                                </div>
                                <div [hidden]="!secteur.errors?.maxlength">
                                    Ce champ ne peut pas comporter plus de 200 caractères.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="text" [(ngModel)]="report.pays_societe" #pays="ngModel" 
                            class="form-control nature" name="pays" placeholder="Pays*" [required]="!stageDisabled" 
                            [maxlength]="stageDisabled ? false : 20" [disabled]="stageDisabled"/>
                            <span class="unit">Pays : </span>
                            <div *ngIf="pays.errors && (pays.dirty || pays.touched)" class="alert alert-danger">
                                <div [hidden]="!pays.errors?.required">
                                    Le pays du stage est requis.
                                </div>
                                <div [hidden]="!pays.errors?.maxlength">
                                    Ce champ ne peut pas comporter plus de 20 caractères.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="text" [(ngModel)]="report.ville_societe" #ville="ngModel"
                            class="form-control nature" name="ville" placeholder="Ville*" [required]="!stageDisabled" 
                            [maxlength]="stageDisabled ? false : 20" [disabled]="stageDisabled"/>
                            <span class="unit">Ville : </span>
                            <div *ngIf="ville.errors && (ville.dirty || ville.touched)" class="alert alert-danger">
                                <div [hidden]="!ville.errors?.required">
                                    La ville du stage est requise.
                                </div>
                                <div [hidden]="!ville.errors?.maxlength">
                                    Ce champ ne peut pas comporter plus de 20 caractères.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="text" [(ngModel)]="report.details_add_societe" [disabled]="stageDisabled"
                            class="form-control nature" name="details" placeholder="Plus de détails sur la société*"/>
                            <span class="unit">Détails : </span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="text" [(ngModel)]="report.encadrant" #nom="ngModel" name="nom"
                            class="form-control nature" placeholder="Nom d'encadrant*" [required]="!stageDisabled" 
                            [maxlength]="stageDisabled ? false : 200" [disabled]="stageDisabled" />
                            <span class="unit">Nom d'encadrant: </span>
                            <div *ngIf="nom.errors && (nom.dirty || nom.touched)" class="alert alert-danger">
                                <div [hidden]="!nom.errors?.required">
                                    Le nom d'encadrant est requis.
                                </div>
                                <div [hidden]="!nom.errors?.maxlength">
                                    Ce champ ne peut pas comporter plus de 200 caractères.
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="text" [(ngModel)]="report.email_encadrant" #email="ngModel" name="email"
                            class="form-control nature" placeholder="Email d'encadrant*" [required]="!stageDisabled"
                            pattern="[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$" 
                            [disabled]="stageDisabled" />
                            <span class="unit">Email d'encadrant: </span>
                            <div *ngIf="email.errors && (email.dirty || email.touched)" class="alert alert-danger">
                                <div [hidden]="!email.errors?.required">
                                    L'email d'encadrant est requis.
                                </div>
                                <div [hidden]="!email.errors?.pattern">
                                    Veuillez entrer un email valide !
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="tel" [(ngModel)]="report.telephone_encadrant" #tel="ngModel" name="tel"
                            class="form-control nature" placeholder="Tél° d'encadrant*" [required]="!stageDisabled" 
                            [disabled]="stageDisabled" pattern="^\+[1-9]{1}[0-9]{3,14}$" />
                            <span class="unit">téléphone d'encadrant: </span>
                            <div *ngIf="tel.errors && (tel.dirty || tel.touched)" class="alert alert-danger">
                                <div [hidden]="!tel.errors?.required">
                                    Le numéro de téléphone d'encadrant est requis.
                                </div>
                                <div [hidden]="!tel.errors?.pattern">
                                    Veuillez entrer un numéro de téléphone valide (Format: +...) !
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <p>Le rapport du stage/projet</p>
                <div class="row">
                    <div class="col">
                        <div class="form-group input-box">
                            <input type="file" [(ngModel)]="report.fichier_rapport" 
                            class="form-control" name="fichier_rapport" placeholder="lien du rapport*" required
                            (change)="handleFileInput($event.target.files)" style="padding-top: 3px;padding-bottom: 3px;"/>
                            <span class="unit">PDF du rapport: </span>
                        </div>
                    </div>
                </div>
                <p>Résumé du rapport</p>
                <div class="row">
                    <div class="col">
                        <div class="form-group input-box">
                            <textarea type="text" [(ngModel)]="report.resume_rapport" required #resume_rapport="ngModel" 
                                class="form-control" name="resume_rapport" placeholder="résume du rapport*" maxlength="3000"
                                style="height: 150px;">
                                <span class="unit">Résumé du rapport : </span>
                                <div *ngIf="resume_rapport.errors && (resume_rapport.dirty || resume_rapport.touched)" class="alert alert-danger">
                                    <div [hidden]="!resume_rapport.errors?.required">
                                        Le résumé du rapport est requis.
                                    </div>
                                    <div [hidden]="!resume_rapport.errors?.maxlength">
                                        Ce champ ne peut pas comporter plus de 3000 caractères.
                                    </div>
                                </div>   
                            </textarea>    
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group row input-box">
                            <input class="col-auto" style="margin:1.5%;" type="checkbox" name="rapport_confidentiel" 
                                [(ngModel)]="report.rapport_confidentiel">
                            
                            <label class="col-form-label col-sm-4">Rapport confidentiel </label>
                        </div>
                    </div>
                </div>
                <div style="display: none; color:red;" id="ValidityFormWarn" class="alert "> 
                    Veuillez vérifier que tout les champs sont bien remplies ! 
                </div> 
                <div class="row" style="margin-top: 30px;">
                    <div class="col-6"></div>
                    <div class="col-6 " id="submitBtnDiv" 
                    style="display:inline-block; position:relative; padding-bottom: 0%;"
                    (click)="ValidityWarn()">
                    <button 
                        id="submitBtn"
                        type="submit"
                        [disabled]="!reportForm.form.valid"
                        class="btnContact "
                        >
                    Envoyer</button>           
                    </div>
                </div>
                
        </form>
</div>
<div class="container contact-form" *ngIf="submitted">
    <br/><br/><br/><br/><br/>
    <h4 style="text-align:center;"> Le rapport est ajouté avec succès ! </h4>
    <br/>
    <button class="btnContact "
        routerLink="/rapport/etudiant/{{currentStudent.id}}">
        Retour vers mes rapports
    </button>
    <br/><br/><br/><br/><br/>
</div>